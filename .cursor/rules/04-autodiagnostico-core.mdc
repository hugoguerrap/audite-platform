---
alwaysApply: true
---
# MÃ³dulo AutodiagnÃ³stico - Core del Producto

## ğŸ¯ ARQUITECTURA DEL AUTODIAGNÃ“STICO

### ğŸ“± Frontend (100% Funcional)
```typescript
// FLUJO PRINCIPAL:
[src/pages/Home.tsx](mdc:audite-frontend-explorer/src/pages/Home.tsx) 
  â†’ Link to="/diagnostico" 
  â†’ [src/pages/Autodiagnostico/AutodiagnosticoPage.tsx](mdc:audite-frontend-explorer/src/pages/Autodiagnostico/AutodiagnosticoPage.tsx)
  â†’ [src/hooks/useAutodiagnostico.ts](mdc:audite-frontend-explorer/src/hooks/useAutodiagnostico.ts)
  â†’ [src/pages/Autodiagnostico/AutodiagnosticoComplete.tsx](mdc:audite-frontend-explorer/src/pages/Autodiagnostico/AutodiagnosticoComplete.tsx)
```

### ğŸ–¥ï¸ Backend (100% Funcional)
```python
# ENDPOINTS ACTIVOS:
[app/routers/autodiagnostico.py](mdc:audite/app/routers/autodiagnostico.py)
  â†’ GET /autodiagnostico/preguntas           # Preguntas pÃºblicas
  â†’ POST /autodiagnostico/responder          # Enviar respuestas
  â†’ GET /autodiagnostico/sugerencias/{id}    # Obtener sugerencias
```

## ğŸ”„ FLUJO DE DATOS

### ğŸ“Š Ciclo de Vida de una SesiÃ³n
1. **Inicio**: `useAutodiagnostico` genera UUID de sesiÃ³n
2. **Carga**: `fetchPreguntas()` obtiene preguntas activas del admin
3. **InteracciÃ³n**: Usuario responde paso a paso
4. **EnvÃ­o**: `submitRespuestas()` envÃ­a todas las respuestas
5. **Sugerencias**: `fetchSugerencias()` obtiene recomendaciones
6. **Contacto**: WhatsApp/Email predefinidos

### ğŸ›ï¸ GestiÃ³n Admin â†’ Frontend
```typescript
// SINCRONIZACIÃ“N AUTOMÃTICA:
Admin crea pregunta â†’ Aparece inmediatamente en /diagnostico
Admin desactiva pregunta â†’ Desaparece del formulario
Admin modifica opciones â†’ Se actualiza en tiempo real
```

## ğŸ§© COMPONENTES CLAVE

### ğŸ¯ AutodiagnosticoPage.tsx
- **Estado**: Gestiona currentStep, progress, sessionId
- **NavegaciÃ³n**: Maneja next/prev con validaciÃ³n
- **EnvÃ­o**: Coordina el envÃ­o final de respuestas
- **Error handling**: Loading states y error management

### ğŸ£ useAutodiagnostico.ts Hook
```typescript
// FUNCIONES PRINCIPALES:
fetchPreguntas()         // Carga preguntas dinÃ¡micas
saveRespuesta()          // Guarda respuesta local
submitRespuestas()       // EnvÃ­a al backend
fetchSugerencias()       // Obtiene recomendaciones
generateSessionId()      // UUID Ãºnico por sesiÃ³n
```

### âœ… AutodiagnosticoComplete.tsx
- **Sugerencias**: Muestra recomendaciones personalizadas
- **Contacto**: Enlaces a WhatsApp/Email
- **Restart**: OpciÃ³n de comenzar nuevo diagnÃ³stico

## ğŸ“‹ TIPOS DE PREGUNTAS SOPORTADAS

### ğŸ›ï¸ ConfiguraciÃ³n DinÃ¡mica (desde Admin)
```typescript
// TIPOS DISPONIBLES:
'radio'       // SelecciÃ³n Ãºnica
'checkbox'    // SelecciÃ³n mÃºltiple  
'text'        // Texto libre
'number'      // NÃºmeros
'select'      // Dropdown
'ordering'    // Ordenamiento (especial)
```

### ğŸ’¡ Sistema de Sugerencias
- **Sugerencias por opciÃ³n**: Cada respuesta puede tener sugerencia especÃ­fica
- **GeneraciÃ³n automÃ¡tica**: Backend procesa respuestas y genera sugerencias
- **Contacto directo**: Enlaces para continuar con asesorÃ­a

## ğŸ”§ MODIFICACIONES SEGURAS

### âœ… Puedes modificar:
- **UI/UX** de los componentes en [src/pages/Autodiagnostico/](mdc:audite-frontend-explorer/src/pages/Autodiagnostico/)
- **LÃ³gica de navegaciÃ³n** en AutodiagnosticoPage.tsx
- **Estilos y animaciones**
- **Textos y copy**
- **Enlaces de contacto**

### ğŸš« NO toques:
- **URLs de API** (estÃ¡n en [src/config/api.ts](mdc:audite-frontend-explorer/src/config/api.ts))
- **LÃ³gica de sessionId** (crÃ­tica para tracking)
- **Estructura de respuestas** (debe coincidir con backend)
- **Hook useAutodiagnostico** (a menos que sepas lo que haces)

## ğŸ“Š DEBUGGING

### ğŸ” Logs Ãºtiles:
```typescript
// EN useAutodiagnostico.ts:
console.log('SessionId enviado:', sessionId);
console.log('Respuestas a enviar:', respuestasParaEnviar);
console.log('Sugerencias recibidas:', data.sugerencias);
```

### ğŸ› Problemas comunes:
1. **SessionId undefined** â†’ Verificar generateSessionId()
2. **Sugerencias no cargan** â†’ Verificar que sessionId sea vÃ¡lido
3. **Preguntas no aparecen** â†’ Verificar que admin las activÃ³
4. **NavegaciÃ³n rota** â†’ Verificar isCurrentStepValid()
